////
// Автор це Богданович Давид Когут Прихожденко та Організація Мавки та Організація Організацій
////

взяти визначення МаМа;

секція МаМа {
  місцева дія назва_з_ю8(М: адреса<Машина>, значення: Ю8): адреса<Назва> {
    вернути знайти_або_виділити_й_додати_назву_з_ю8(М.БН::адреса, значення);
  }

  місцева дія позиція_назви_з_ю8(М: адреса<Машина>, значення: Ю8): п32 {
    вернути додати_назву_з_ю8(М.БН::адреса, значення) як п32;
  }

  місцева дія перевірити_чи_назви_рівні(назва1: адреса<Назва>, назва2: адреса<Назва>): логічне {
    вернути назва1 == назва2;
  }

  місцева дія виділити_назву(кодування: п8, значення: памʼять<п8>): адреса<Назва> {
    ціль назва = виділити<Назва>();
    назва.кодування = кодування;
    назва.значення = виділити_копію_ю8(значення);
    вернути назва;
  }

  місцева дія зробити_базу_назв(): БазаНазв {
    ціль БН: БазаНазв;
    БН.дані = зробити_накопичувач<адреса<Назва>>();
    БН.С.предок = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"предок");
    БН.С.чародія_додати = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_додати");
    БН.С.чародія_відняти = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_відняти");
    БН.С.чародія_помножити = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_помножити");
    БН.С.чародія_поділити = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_поділити");
    БН.С.чародія_отримати_остачу_ділення = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_отримати_остачу_ділення");
    БН.С.чародія_отримати_частку_ділення = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_отримати_частку_ділення");
    БН.С.чародія_піднести_до_степеня = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_піднести_до_степеня");
    БН.С.чародія_зсунути_вліво = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_зсунути_вліво");
    БН.С.чародія_зсунути_вправо = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_зсунути_вправо");
    БН.С.чародія_зсунути_вправо_зі_заповненням = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_зсунути_вправо_зі_заповненням");
    БН.С.чародія_двійкове_і = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_двійкове_і");
    БН.С.чародія_двійкове_або = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_двійкове_або");
    БН.С.чародія_двійкове_виключне_або = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_двійкове_виключне_або");
    БН.С.чародія_двійкове_не = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_двійкове_не");
    БН.С.чародія_більше = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_більше");
    БН.С.чародія_менше = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_менше");
    БН.С.чародія_містить = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_містить");
    БН.С.чародія_відʼємне = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_відʼємне");
    БН.С.чародія_додатнє = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_додатнє");
    БН.С.чародія_не_більше = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_не_більше");
    БН.С.чародія_не_менше = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_не_менше");
    БН.С.чародія_виконати = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_виконати");
    БН.С.чародія_отримати_елемент = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_отримати_елемент");
    БН.С.чародія_змінити_елемент = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_змінити_елемент");
    БН.С.чародія_перебір = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"чародія_перебір");
    БН.С.обʼєкт = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"обʼєкт");
    БН.С.Структура = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"Структура");
    БН.С.НативнаДія = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"НативнаДія");
    БН.С.Дія = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"Дія");
    БН.С.число = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"число");
    БН.С.текст = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"текст");
    БН.С.юнікод = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"юнікод");
    БН.С.друк = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"друк");
    БН.С.значення = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"значення");
    БН.С.модуль = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"модуль");
    БН.С.біб = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"біб");
    БН.С.пак = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"пак");
    БН.С.Модуль = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"Модуль");
    БН.С.список = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"список");
    БН.С.словник = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"словник");
    БН.С.логічне = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"логічне");
    БН.С.так = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"так");
    БН.С.ні = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"ні");
    БН.С.додати = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"додати");
    БН.С.значення = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"значення");
    БН.С.назва = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"назва");
    БН.С.забрати = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"забрати");
    БН.С.ключ = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"ключ");
    БН.С.розмір = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"розмір");
    БН.С.довжина = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"довжина");
    БН.С.фільтр = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"фільтр");
    БН.С.д = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"д");
    БН.С.новий_список = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"новий_список");
    БН.С.знайти = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"знайти");
    БН.С.знайти_позицію = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"знайти_позицію");
    БН.С.перетворити = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"перетворити");
    БН.С.обернути = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"обернути");
    БН.С.М = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"М");
    БН.С.мавка = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"мавка");
    БН.С.МаМа = знайти_або_виділити_й_додати_назву_з_ю8(БН::адреса, ю8"МаМа");
    вернути БН;
  }

  місцева дія додати_назву_з_ю8(БН: адреса<БазаНазв>, значення: Ю8): позитивне {
    ціль розмір_значення_ю8 = strlen(значення);
    змінна ціль кодування: п8 = КОДУВАННЯ_НАЗВИ_Ю8;
    ціль значення_КД = виділити<п8>(розмір_значення_ю8 + 1);
    ціль розмір_перекодованого_в_КД = КД::перекодувати_з_Ю8(значення, розмір_значення_ю8 як позитивне, значення_КД);
    якщо розмір_перекодованого_в_КД == 0 {
      кодування = КОДУВАННЯ_НАЗВИ_Ю8;
    } інакше {
      значення_КД[розмір_перекодованого_в_КД] = 0;
      значення = значення_КД;
      кодування = КОДУВАННЯ_НАЗВИ_КД;
    }
    змінна ціль позиція: позитивне = 0;
    поки позиція < БН.дані.розмір {
      ціль назва = БН.дані.дані[позиція];
      якщо назва.кодування == кодування {
        якщо перевірити_чи_ю8_рівні(назва.значення, значення) {
          вернути позиція;
        }
      }
      позиція = позиція + 1;
    }
    ціль назва = виділити_назву(кодування, значення);
    звільнити(значення_КД);
    покласти_в_накопичувач<адреса<Назва>>(БН.дані::адреса, назва);
    вернути БН.дані.розмір - 1;
  }

  місцева дія знайти_або_виділити_й_додати_назву_з_ю8(БН: адреса<БазаНазв>, значення: Ю8): адреса<Назва> {
    ціль позиція_назви = додати_назву_з_ю8(БН, значення);
    вернути БН.дані.дані[позиція_назви];
  }

  місцева дія виділити_ю8_з_назви(М: адреса<Машина>, назва: адреса<Назва>, вихід: адреса<Ю8>): логічне {
    якщо назва.кодування == КОДУВАННЯ_НАЗВИ_Ю8 {
      вихід[0] = виділити_копію_ю8(назва.значення);
      вернути так;
    } інакше {
      ціль розмір_значення_КД = strlen(назва.значення);
      ціль значення_ю8 = виділити<п8>((розмір_значення_КД * 3) + 1);
      ціль розмір_перекодованого_в_Ю8 = КД::перекодувати_в_Ю8(назва.значення, розмір_значення_КД як позитивне, значення_ю8);
      якщо розмір_перекодованого_в_Ю8 == 0 {
        надрукувати_ю8(ю8"!!! Щось пішло не так під час отримання Ю8 з назви!");
        вернути ні;
      } інакше {
        значення_ю8[розмір_перекодованого_в_Ю8] = 0;
        вихід[0] = значення_ю8;
        вернути так;
      }
    }
  }

  місцева дія перевірити_чи_назва_чародія(М: адреса<Машина>, назва: адреса<Назва>): логічне {
    якщо назва == М.БН.С.чародія_отримати_елемент {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_змінити_елемент {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_перебір {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_додати {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_відняти {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_помножити {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_поділити {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_отримати_остачу_ділення {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_отримати_частку_ділення {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_піднести_до_степеня {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_зсунути_вліво {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_зсунути_вправо {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_зсунути_вправо_зі_заповненням {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_двійкове_і {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_двійкове_або {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_двійкове_виключне_або {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_двійкове_не {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_більше {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_менше {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_містить {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_відʼємне {
      вернути так;
    }
    якщо назва == М.БН.С.чародія_додатнє {
      вернути так;
    }
    вернути ні;
  }
}